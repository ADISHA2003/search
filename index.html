<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Search</title>

    <style>
        :root {
            --bg: #f5f7fa;
            --card: #ffffff;
            --border: #e2e8f0;
            --text: #0f172a;
            --text-light: #64748b;
            --accent: #0ea5a4;
            --hover: #f1f5f9;
            --radius: 14px;
            font-family: Inter, system-ui, sans-serif;
        }

        body {
            margin: 0;
            padding: 16px;
            background: var(--bg);
            color: var(--text);
            display: flex;
            justify-content: center;
        }

        .container {
            width: 100%;
            max-width: 700px;
        }

        .card {
            background: var(--card);
            padding: 20px 22px;
            border-radius: var(--radius);
            box-shadow: 0 4px 18px rgba(0, 0, 0, 0.05);
        }

        h1 {
            margin: 0;
            font-size: 22px;
            font-weight: 700;
        }

        .sub {
            margin-top: 4px;
            margin-bottom: 16px;
            font-size: 14px;
            color: var(--text-light);
        }

        /* Search bar */
        .search-row {
            display: flex;
            gap: 10px;
        }

        input[type="search"] {
            flex: 1;
            padding: 12px 14px;
            border: 1px solid var(--border);
            border-radius: var(--radius);
            font-size: 16px;
            background: #fff;
        }

        button {
            border: 0;
            background: var(--accent);
            padding: 12px 18px;
            border-radius: var(--radius);
            color: white;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(14, 165, 164, 0.3);
            transition: 0.2s;
        }

        button:hover {
            opacity: 0.9;
        }

        .hint {
            margin-top: 6px;
            font-size: 13px;
            color: var(--text-light);
        }

        /* Suggestions */
        ul.suggestions {
            list-style: none;
            padding: 0;
            margin: 12px 0 0;
            border: 1px solid var(--border);
            border-radius: var(--radius);
            overflow: hidden;
            background: #fff;
        }

        li.suggestion {
            padding: 12px 14px;
            font-size: 16px;
            cursor: pointer;
            border-bottom: 1px solid var(--border);
        }

        li.suggestion:last-child {
            border-bottom: none;
        }

        li.suggestion:hover,
        li.suggestion.focused {
            background: var(--hover);
        }

        .links {
            margin-top: 14px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        a.small {
            font-size: 13px;
            padding: 10px 14px;
            border-radius: var(--radius);
            border: 1px solid var(--border);
            text-decoration: none;
            color: var(--text);
            background: #fff;
        }

        footer {
            margin-top: 20px;
            text-align: center;
            font-size: 12px;
            color: var(--text-light);
        }

        /* Mobile improvements */
        @media (max-width: 480px) {
            .card {
                padding: 18px;
            }

            h1 {
                font-size: 20px;
            }

            input[type="search"] {
                font-size: 15px;
                padding: 11px;
            }

            button {
                padding: 11px 14px;
                font-size: 14px;
            }

            li.suggestion {
                font-size: 15px;
                padding: 11px 13px;
            }
        }
    </style>
</head>

<body>

    <div class="container">
        <div class="card">
            <div class="search-row">
                <input id="q" type="search" placeholder="Search anythingâ€¦" />
                <button id="go" disabled>Search</button>
            </div>

            <ul id="suggestions" class="suggestions" hidden></ul>

            <div class="links">
                <a id="open-json" class="small" target="_blank" hidden>Open JSON</a>
                <a id="open-xml" class="small" target="_blank" hidden>Open XML</a>
            </div>

            <footer>Optimized for mobile & desktop. No backend needed.</footer>
        </div>
    </div>

    <script>
        // Same JS functionality as before
        (function() {
            const input = document.getElementById('q');
            const go = document.getElementById('go');
            const list = document.getElementById('suggestions');
            const openJson = document.getElementById('open-json');
            const openXml = document.getElementById('open-xml');

            let timer = null;
            let lastToken = 0;
            let focusedIndex = -1;
            let currentSuggestions = [];
            const DEBOUNCE = 250;
            const JSONP_TIMEOUT = 1000;

            function escapeHtml(s) {
                return String(s).replace(/[&<>\"]/g, c => ({
                    "&": "&amp;",
                    "<": "&lt;",
                    ">": "&gt;",
                    "\"": "&quot;"
                } [c] || c));
            }

            function buildSuggestUrl(q) {
                const enc = encodeURIComponent(q);
                return {
                    jsonp: `https://suggestqueries.google.com/complete/search?client=firefox&ds=yt&q=${enc}&callback=handleSuggest`,
                    xml: `https://suggestqueries.google.com/complete/search?client=toolbar&ds=yt&q=${enc}`,
                    plainJson: `https://suggestqueries.google.com/complete/search?client=firefox&ds=yt&q=${enc}`
                };
            }

            function clearSuggestions() {
                list.hidden = true;
                list.innerHTML = '';
                focusedIndex = -1;
                currentSuggestions = [];
                openJson.hidden = true;
                openXml.hidden = true;
            }

            function showSuggestions(arr) {
                currentSuggestions = arr;
                list.innerHTML = '';

                if (!arr.length) {
                    clearSuggestions();
                    return;
                }

                arr.forEach((s, i) => {
                    const li = document.createElement('li');
                    li.className = 'suggestion';
                    li.textContent = s;
                    li.addEventListener('click', () => openOnGoogle(s));
                    li.addEventListener('mousemove', () => setFocus(i));
                    list.appendChild(li);
                });

                list.hidden = false;
                setFocus(0);
            }

            function setFocus(i) {
                const items = list.querySelectorAll('.suggestion');
                if (!items.length) return;
                if (focusedIndex >= 0 && items[focusedIndex]) items[focusedIndex].classList.remove('focused');
                focusedIndex = Math.max(0, Math.min(i, items.length - 1));
                items[focusedIndex].classList.add('focused');
            }

            function openOnGoogle(q) {
                window.open(`https://www.google.com/search?q=${encodeURIComponent(q)}`, '_blank');
            }

            window.handleSuggest = function(resp) {
                try {
                    const arr = resp[1] || [];
                    showSuggestions(arr.map(s => typeof s === 'string' ? s : s[0]));
                } catch {
                    clearSuggestions();
                }
            };

            function fetchSuggestions(q) {
                if (!q) {
                    clearSuggestions();
                    return;
                }
                const token = ++lastToken;
                const {
                    jsonp,
                    xml,
                    plainJson
                } = buildSuggestUrl(q);

                const script = document.createElement('script');
                script.src = jsonp;
                script.id = 'jsonp_' + token;
                script.async = true;

                let called = false;
                const t = setTimeout(() => {
                    if (called) return;
                    openJson.href = plainJson;
                    openXml.href = xml;
                    openJson.hidden = false;
                    openXml.hidden = false;
                    clearSuggestions();
                    script.remove();
                }, JSONP_TIMEOUT);

                const orig = window.handleSuggest;
                window.handleSuggest = function(resp) {
                    called = true;
                    clearTimeout(t);
                    orig(resp);
                    window.handleSuggest = orig;
                };

                document.body.appendChild(script);
            }

            input.addEventListener('input', () => {
                clearTimeout(timer);
                timer = setTimeout(() => fetchSuggestions(input.value.trim()), DEBOUNCE);
            });

            input.addEventListener('keydown', e => {
                const items = list.querySelectorAll('.suggestion');
                if (e.key === 'ArrowDown') {
                    e.preventDefault();
                    setFocus(focusedIndex + 1);
                } else if (e.key === 'ArrowUp') {
                    e.preventDefault();
                    setFocus(focusedIndex - 1);
                } else if (e.key === 'Enter') {
                    e.preventDefault();
                    if (items[focusedIndex]) openOnGoogle(items[focusedIndex].textContent);
                    else openOnGoogle(input.value.trim());
                } else if (e.key === 'Escape') {
                    clearSuggestions();
                }
            });

            input.addEventListener('input', () => {
                go.disabled = input.value.trim().length === 0;
                clearTimeout(timer);
                timer = setTimeout(() => fetchSuggestions(input.value.trim()), DEBOUNCE);
            });

            go.addEventListener('click', () => openOnGoogle(input.value.trim()));

            document.addEventListener('click', e => {
                if (!e.target.closest('.card')) clearSuggestions();
            });

        })();
    </script>

</body>

</html>